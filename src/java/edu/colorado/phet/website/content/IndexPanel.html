<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:wicket="http://wicket.apache.org/dtds.data/wicket-xhtml1.4-strict.dtd" xml:lang="en"
      lang="en">
<head>
    <title wicket:id="page-title">Wicket Prototype Index Page</title>
    <wicket:remove>
        <link rel="stylesheet" type="text/css" href="../../../../../../../root/css/preview.css"/>
    </wicket:remove>
</head>
<body>

<wicket:panel>
    <script>
        var switchVideo;

        // list all videos here
        var simVideos = [
            { title: 'Balancing Act', path: 'balancing-act' },
            { title: 'Color Vision', path: 'color-vision' },
            { title: 'Energy Skate Park Basics', path: 'energy-skate-park-basics' },
            { title: 'Faraday\'s Law', path: 'faradays-law' },
            { title: 'Friction', path: 'friction' },
            { title: 'John Travoltage', path: 'john-travoltage' },
            { title: 'Wave on a String', path: 'wave-on-a-string' }
        ];

        document.addEventListener( 'DOMContentLoaded', function() {
            var sourceIndex = 0;
            var locale = ( window.location.pathname === '/' ) ? '/en/' : window.location.pathname;
            var sourceFiles = [];
            for ( var i = 0; i < simVideos.length; i++ ) {
                var prefix = '/files/rotator/' + simVideos[i].path;
                sourceFiles.push( {
                    sources: [prefix + '.mp4', prefix + '.ogv'],
                    title: simVideos[i].title,
                    link: 'simulation/' + simVideos[i].path,
                    fallback: prefix + '.jpg' } );
            }

            var videos = [];
            var sources = [];
            var fallbackImages = [];

            var container = document.getElementById( 'video-container' );
            var simName = document.getElementById( 'sim-name' );

            var timer; // setInterval for changing videos
            var switchable = true; // whether or not the switch video buttons are enabled (they get disabled while animating)
            var currentIndex = 0; // index of the current video and source

            // add the video elements in divs
            for ( var i = 0; i < 3; i++ ) {
                var div = document.createElement( 'div' );
                var widthValue = (i === 0) ? 0 : (i === 1) ? 100 : -100;
                div.setAttribute( 'class', 'box' );
                div.setAttribute( 'style', 'margin-top: 0; ' +
                                           'position: absolute; ' +
                                           'width: 100%; ' +
                                           'height: 100%; ' +
                                           'left: ' + widthValue + '%;' );

                videos.push( document.createElement( 'video' ) );
                // using width and height 100% doesn't work in FF, so its hardcoded here
                videos[i].setAttribute( 'width', '325px' );
                videos[i].setAttribute( 'height', '213px' );
                videos[i].setAttribute( 'muted', '' );

                sources.push( document.createElement( 'source' ) );
                sources.push( document.createElement( 'source' ) );
                sources[2 * i].setAttribute( 'type', 'video/mp4' );
                sources[2 * i + 1].setAttribute( 'type', 'video/ogg' );

                fallbackImages.push( document.createElement( 'img' ) );
                fallbackImages[i].setAttribute( 'width', '325px' );
                fallbackImages[i].setAttribute( 'height', '213px' );

                videos[i].appendChild( sources[2 * i] );
                videos[i].appendChild( sources[2 * i + 1] );
                videos[i].appendChild( fallbackImages[i] );

                div.appendChild( videos[i] );

                container.appendChild( div );
            }

            switchVideo = function( direction ) {
                if ( !switchable ) {
                    return;
                }
                switchable = false;

                currentIndex = ( direction === 'left' ) ? ( currentIndex + 1 ) % 3 : ( currentIndex - 1 );
                if ( currentIndex < 0 ) {
                    currentIndex += 3;
                }

                if ( direction === 'left' ) {
                    $( '.box' ).each( function() {
                        if ( $( this ).offset().left < $( '#video-container' ).offset().left ) {
                            $( this ).css( 'left', '100%' );
                        }
                        else if ( $( this ).offset().left >= $( '#video-container' ).offset().left + $( '#video-container' ).width() ) {
                            $( this ).animate( {
                                left: '0%'
                            }, 1000 );
                        }
                        else {
                            $( this ).animate( {
                                left: '-100%'
                            }, 1000 );
                        }
                    } );
                }
                else {
                    $( '.box' ).each( function() {
                        if ( $( this ).offset().left < $( '#video-container' ).offset().left ) {
                            $( this ).animate( {
                                left: '0%'
                            }, 1000 );
                        }
                        else if ( $( this ).offset().left >= $( '#video-container' ).offset().left + $( '#video-container' ).width() ) {
                            $( this ).css( 'left', '-100%' );
                        }
                        else {
                            $( this ).animate( {
                                left: '100%'
                            }, 1000 );
                        }
                    } );
                }

                // setup and start the next video
                sourceIndex = ( sourceIndex + 1 ) % sourceFiles.length;

                sources[2 * currentIndex].setAttribute( 'src', sourceFiles[sourceIndex].sources[0] );
                sources[2 * currentIndex + 1].setAttribute( 'src', sourceFiles[sourceIndex].sources[1] );
                fallbackImages[currentIndex].setAttribute( 'src', sourceFiles[sourceIndex].fallback );
                videos[currentIndex].setAttribute( 'poster', sourceFiles[sourceIndex].fallback );
                videos[currentIndex].load();
                videos[currentIndex].play();
                simName.innerHTML = sourceFiles[sourceIndex].title;
                var href = locale + sourceFiles[sourceIndex].link;
                simName.setAttribute( 'href', href );
                document.getElementById( 'video-container' ).onclick = function() { window.location.href = href; };

                // restart the timer
                clearInterval( timer );
                timer = setInterval( function() {switchVideo( 'left' );}, 5000 );

                // set a timeout to ensure the button can't be pressed while animating
                setTimeout( function() {switchable = true;}, 1000 );
            };

            // start the first video
            sources[2 * currentIndex].setAttribute( 'src', sourceFiles[sourceIndex].sources[0] );
            sources[2 * currentIndex + 1].setAttribute( 'src', sourceFiles[sourceIndex].sources[1] );
            fallbackImages[currentIndex].setAttribute( 'src', sourceFiles[sourceIndex].fallback );
            videos[currentIndex].setAttribute( 'poster', sourceFiles[sourceIndex].fallback );
            videos[currentIndex].play();
            simName.innerHTML = sourceFiles[sourceIndex].title;
            var href = locale + sourceFiles[sourceIndex].link;
            simName.setAttribute( 'href', href );
            document.getElementById( 'video-container' ).onclick = function() { window.location.href = href; };

            // switch videos every 5 seconds
            timer = setInterval( function() {switchVideo( 'left' );}, 5000 );

        }, false );

    </script>

    <div id="main-content" class="index-content" wicket:message="dir:language.dir">
        <div id="index-middle-div">

            <div id="left-index" wicket:message="dir:language.dir">

                <div style="font-size:20px"><strong>INTERACTIVE</strong> SIMULATIONS<br/>FOR SCIENCE AND MATH</div>

                <a class="play-with-sims-button" href="#" wicket:id="play-sims-link" style="margin-top: 30px">
                    <div>
                        <div style="font-size: 20px; width: 70%; float: left; text-align: left;">
                            <wicket:message key="home.playWithSims">Play with Simulations</wicket:message>
                        </div>
                        <div style="float: right;">
                            <img src="#" alt="PhET Airplane" style="border: none" wicket:id="phet-airplane"/>
                        </div>
                    </div>
                </a>

                <a href="#" wicket:id="techAwardLink" style="display: table-row; vertical-align: bottom; height: 1px;">
                    <img style="border: none" src="#" wicket:id="award-logo"/>
                </a>

            </div>

            <div id="index-animated-screenshot-holder">
                <div id="video-container">
                </div>
                <div id="controls-container">
                    <span class="left-right-buttons" style="float: left;" onclick="switchVideo('right');">
                        <img class="left-right-img" src="/images/icons/left.png" alt="<">
                    </span>
                    <a id="sim-name"></a>
                    <span class="left-right-buttons" style="float: right;" onclick="switchVideo('left');">
                        <img class="left-right-img" src="/images/icons/right.png" alt=">">
                    </span>
                </div>
            </div>

            <wicket:enclosure child="social-bookmark-panel">
                <div id="social-icons" wicket:id="social-bookmark-panel" wicket:message="dir:language.dir"></div>
            </wicket:enclosure>
        </div>
    </div>

    <div class="practices">
        <dl class="get-phet-links">
            <dt>
                <a href="#" wicket:id="run-our-sims-link">
                    <span wicket:id="run-our-sims-label"></span>
                    <!--<wicket:message key="home.runOurSims">How to Run Simulations</wicket:message>-->
                </a>
            </dt>
            <wicket:enclosure child="on-line-link">
                <dd>
                    <a href="#" wicket:id="on-line-link">
                        <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                        <wicket:message key="home.onLine">On Line</wicket:message>
                    </a>
                </dd>
            </wicket:enclosure>
            <wicket:enclosure child="full-install-link">
                <dd>
                    <a href="#" wicket:id="full-install-link">
                        <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                        <wicket:message key="home.fullInstallation">Full Installation</wicket:message>
                    </a>
                </dd>
            </wicket:enclosure>
            <wicket:enclosure child="one-at-a-time-link">
                <dd>
                    <a href="#" wicket:id="one-at-a-time-link">
                        <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                        <wicket:message key="home.oneAtATime">One at a Time</wicket:message>
                    </a>
                </dd>
            </wicket:enclosure>
            <dd style="margin-top: 1em;">
                <a href="#" wicket:id="troubleshooting-link">
                    <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.troubleshooting">Troubleshooting</wicket:message>
                </a>
            </dd>
            <dd>
                <a href="#" wicket:id="faqs-link">
                    <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.faqs">Frequently Asked Questions</wicket:message>
                </a>
            </dd>
        </dl>

        <dl>
            <dt>
                <a href="#" wicket:id="activities-link">
                    <wicket:message key="home.teacherIdeasAndActivities">
                        For Teachers
                    </wicket:message>
                </a>
            </dt>
            <wicket:enclosure child="tipsforusingphet-link">
                <dd>
                    <a href="#" wicket:id="tipsforusingphet-link">
                        <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                        <wicket:message key="tipsForUsingPhet">Tips for Using PhET</wicket:message>
                    </a>
                </dd>
            </wicket:enclosure>
            <wicket:enclosure child="browse-activities-link">
                <dd>
                    <a href="#" wicket:id="browse-activities-link">
                        <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                        <wicket:message key="home.browseActivities">
                            Browse Activities
                        </wicket:message>
                    </a>
                </dd>
            </wicket:enclosure>
            <dd>
                <a href="#" wicket:id="submit-activity-link" id="home-submit-activity-link">
                    <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.submitActivity">Contribute Activities</wicket:message>
                </a>
            </dd>
            <dd>
                <a href="#" wicket:id="workshops-link">
                    <img id="green-arrow-image" src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.workshops">Workshops and Materials</wicket:message>
                </a>
            </dd>
            <dd style="margin-top: 1em;">
                <a href="#" wicket:id="translate-sims-link">
                    <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.translateSimulations">Translate simulations</wicket:message>
                </a>
            </dd>
            <dd>
                <wicket:enclosure>
                    <a href="#" wicket:id="test-translation">
                        <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                        <wicket:message key="home.translateWebsite">Translate the website</wicket:message>
                    </a>
                </wicket:enclosure>
            </dd>
        </dl>

        <dl>
            <dt>
                <a href="#" wicket:id="about-general">
                    <wicket:message key="home.about">About</wicket:message>
                </a>
            </dt>
            <dd>
                <a href="#" wicket:id="about-news">
                    <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.about.news">What's New?</wicket:message>
                </a>
            </dd>
            <dd>
                <a href="#" wicket:id="about-phet">
                    <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.about.phet">About PhET</wicket:message>
                </a>
            </dd>
            <dd>
                <a href="#" wicket:id="about-contact">
                    <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.about.contact">Contact Us</wicket:message>
                </a>
            </dd>
            <dd style="margin-top: 1em;">
                <a href="#" wicket:id="support-phet-link">
                    <img src="/images/circleArrow_Icon.gif" alt="Green arrow" width="14" height="13"/>
                    <wicket:message key="home.donate">Donate</wicket:message>
                </a>
            </dd>
        </dl>

        <dl class="last">
            <dt>
                <a href="#" wicket:id="sponsors-general">
                    <wicket:message key="home.about.phetSupportedBy">PhET is supported by...</wicket:message>
                </a>
            </dt>
            <dd style="padding: 0 10px 5px; min-height: 70px;" id="featured-sponsor-dd">
                <!-- here we use a table with invisible elements with a specific height to mimic the min-height for a table -->
                <table cellpadding="0" cellspacing="0" style="margin: 0; padding: 0; width: 100%; height: 100%;">
                    <tr>
                        <td style="margin: 0; padding: 0;">
                            <div style="height: 70px; width: 0;"></div>
                        </td>
                        <td style="margin: 0; padding: 0; text-align: center; vertical-align:middle;">
                            <div id="featured-sponsor-spot" style="display: none;"></div>
                            <script type="text/javascript">
                                //<![CDATA[
                                (function() {
                                    var r = Math.random() * phetHomeSponsors.totalWeight;
                                    var i;
                                    for ( i = 0; i <= phetHomeSponsors.sponsors.length; i++ ) {
                                        r -= phetHomeSponsors.sponsors[i].weight;
                                        if ( r <= 0 ) {
                                            break;
                                        }
                                    }
                                    var html = phetHomeSponsors.sponsors[i].html;
                                    document.getElementById( 'featured-sponsor-spot' ).innerHTML = html;
                                    document.getElementById( 'featured-sponsor-spot' ).style.display = "block";
                                })();
                                //]]>
                            </script>
                            <script type="text/javascript" wicket:id="featured-sponsor-installer-js">
                                (function() {
                                    var greenArrowSrc = document.getElementById( "green-arrow-image" ).src;
                                    // 0x2F is a slash, to fool the httrack ripper
                                    var lastIndex = Math.max( greenArrowSrc.lastIndexOf( String.fromCharCode( 0x2F ) ), greenArrowSrc.lastIndexOf( "\\" ) );
                                    var newImagesDirectory = greenArrowSrc.substring( 0, lastIndex );
                                    document.getElementById( 'featured-sponsor-spot' ).innerHTML = document.getElementById( 'featured-sponsor-spot' ).innerHTML.replace( /\/images/g, newImagesDirectory );
                                })();
                            </script>
                            <noscript>
                                <div wicket:id="featured-sponsor-panel"></div>
                            </noscript>
                        </td>
                        <td style="margin: 0; padding: 0;">
                            <div style="height: 70px; width: 0;"></div>
                        </td>
                    </tr>
                </table>
            </dd>
            <dd style="text-align: center;">
                <span wicket:id="other-sponsors"></span>
            </dd>
        </dl>
        <div class="clear">
        </div>
    </div>

    <div class="clear">
    </div>

    <div>
        <table width="100%">
            <tr>
                <td class="sponsor">
                    <a href="http://www.hewlett.org/" wicket:message="dir:language.dir" rel="external">
                        <img wicket:id="hewlett-logo"
                             src="../../../../../../../root/images/support/hewlett-logo-front-page.gif"
                             alt="Hewlett Foundation logo"/>
                    </a>
                </td>
                <td class="sponsor">
                    <a href="http://www.nsf.gov/" wicket:message="dir:language.dir" rel="external">
                        <img wicket:id="nsf-logo"
                             src="../../../../../../../root/images/support/nsf1.gif"
                             alt="NSF Logo"/>
                    </a>
                </td>
                <td class="sponsor">
                    <a href="http://www.odf.org/" wicket:message="dir:language.dir" rel="external">
                        <img wicket:id="odf-logo"
                             src="../../../../../../../root/images/support/odf-combined-130.png"
                             alt="O'Donnell Foundation logo"/>
                    </a>
                </td>
                <td class="sponsor">
                    <a href="http://www.moore.org/" wicket:message="dir:language.dir" rel="external">
                        <img wicket:id="moore-logo"
                             src="../../../../../../../root/images/support/moore-foundation.jpg"
                             alt="Moore Logo"/>
                    </a>
                </td>
            </tr>
        </table>
    </div>

    <div class="index-footer" style="text-align: center; padding-top: 5px; font-size: 12px;">
        <div wicket:id="translation-credits" style="margin-bottom: 5px;" class="translation-credits">
            This is the credits line for the translation.
        </div>

        <span wicket:id="translation-links" style="padding-bottom: 5px;">
            Translation links go here
        </span>

        <wicket:enclosure child="social-footer-list">
            <div style="padding: 10px 0">
                <span wicket:id="social-footer-list">
                    <a wicket:id="link" rel="external,nofollow" target="_blank">
                        <span wicket:id="label">Item</span><img wicket:id="icon"/>
                    </a>
                </span>
            </div>
        </wicket:enclosure>

        <div class="copyright" wicket:id="copyright">
            <span wicket:id="copyright-label">&copy; 2014 University of Colorado. </span>
            <a href="#" wicket:id="some-rights-link">
                <wicket:message key="footer.someRightsReserved">Some rights reserved.</wicket:message>
            </a>
        </div>
    </div>

</wicket:panel>

</body>
</html>

